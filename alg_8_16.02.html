<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ—Ç–æ–¥–∏—á–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫: –ö–≤–∞–¥—Ä–∞—Ç–Ω—ñ –∫–æ—Ä–µ–Ω—ñ —Ç–∞ –î—ñ–π—Å–Ω—ñ —á–∏—Å–ª–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; overflow: hidden; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .task-card { border: 1px solid #e2e8f0; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .task-card:hover { border-color: #3b82f6; box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.1); }
        .whiteboard-container { background-image: radial-gradient(#e2e8f0 1px, transparent 1px); background-size: 20px 20px; }
        .tool-active { @apply bg-blue-600 text-white shadow-md; }
        .solved-card { border-color: #22c55e !important; background-color: #f0fdf4 !important; }
    </style>
</head>
<body class="h-screen flex text-slate-900">

    <div class="w-full lg:w-1/2 flex flex-col bg-white border-r border-slate-200">
        <header class="p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white/80 backdrop-blur-md z-50">
            <div>
                <h1 class="text-2xl font-extrabold text-slate-800">–ê–ª–≥–µ–±—Ä–∞: –ö–≤–∞–¥—Ä–∞—Ç–Ω—ñ –ö–æ—Ä–µ–Ω—ñ</h1>
                <p class="text-xs font-bold text-blue-500 uppercase tracking-widest mt-1">–ö–ª–∞—Å: 8 ‚Ä¢ –†—ñ–≤–µ–Ω—å: –°–µ—Ä–µ–¥–Ω—ñ–π ‚Ä¢ 1 –≥–æ–¥–∏–Ω–∞</p>
            </div>
            <div class="text-right">
                <div class="text-xs font-black text-slate-400 mb-1" id="prog-label">–ü—Ä–æ–≥—Ä–µ—Å: 0/30</div>
                <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                    <div id="prog-bar" class="h-full bg-blue-600 transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto p-8 space-y-12 custom-scrollbar">
            
            <section>
                <details class="group bg-blue-50/50 rounded-3xl border border-blue-100 p-2">
                    <summary class="flex items-center justify-between p-4 cursor-pointer font-bold text-blue-900">
                        <span>üìñ –°—Ç–∏—Å–ª–∞ —Ç–µ–æ—Ä—ñ—è (–®–ø–∞—Ä–≥–∞–ª–∫–∞)</span>
                        <span class="transition-transform group-open:rotate-180">‚ñº</span>
                    </summary>
                    <div class="p-4 pt-0 space-y-3 text-sm text-slate-700 leading-relaxed">
                        <p><strong>–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏–π –∫–æ—Ä—ñ–Ω—å:</strong> \( \sqrt{a} = b \), –¥–µ \( b^2 = a \) —Ç–∞ \( b \ge 0 \).</p>
                        <p><strong>–ú–Ω–æ–∂–∏–Ω–∏ —á–∏—Å–µ–ª:</strong></p>
                        <ul class="list-disc pl-5">
                            <li>\( \mathbb{N} \) ‚Äî –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ñ (1, 2, 3...)</li>
                            <li>\( \mathbb{Z} \) ‚Äî —Ü—ñ–ª—ñ (...-2, -1, 0, 1, 2...)</li>
                            <li>\( \mathbb{Q} \) ‚Äî —Ä–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ (–º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ —è–∫ \( \frac{m}{n} \))</li>
                            <li>\( \mathbb{I} \) ‚Äî —ñ—Ä—Ä–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ (–Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ –Ω–µ–ø–µ—Ä—ñ–æ–¥–∏—á–Ω—ñ –¥—Ä–æ–±–∏, —è–∫ \( \pi \) –∞–±–æ \( \sqrt{2} \))</li>
                            <li>\( \mathbb{R} \) ‚Äî –¥—ñ–π—Å–Ω—ñ (—É—Å—ñ –≤–∏—â–µ–ø–µ—Ä–µ–ª—ñ—á–µ–Ω—ñ)</li>
                        </ul>
                    </div>
                </details>
            </section>

            <div id="tasks-list" class="space-y-10">
                </div>

            <div class="py-10">
                <button onclick="finishLesson()" class="w-full bg-slate-900 text-white py-6 rounded-3xl font-black text-xl hover:bg-blue-600 transition shadow-xl active:scale-[0.98]">
                    –ó–ê–í–ï–†–®–ò–¢–ò –£–†–û–ö
                </button>
            </div>
        </main>
    </div>

    <div class="hidden lg:flex w-1/2 flex-col bg-slate-50 p-6 relative">
        <div class="absolute top-10 left-1/2 -translate-x-1/2 z-40 flex items-center gap-2 bg-white/90 backdrop-blur-md p-3 rounded-2xl shadow-xl border border-slate-200">
            <button onclick="setTool('pen')" id="btn-pen" class="p-3 rounded-xl tool-active">‚úèÔ∏è</button>
            <button onclick="setTool('eraser')" id="btn-eraser" class="p-3 rounded-xl hover:bg-slate-100">üßΩ</button>
            <div class="w-px h-6 bg-slate-200 mx-1"></div>
            <button onclick="clearCanvas()" class="px-4 py-2 text-[10px] font-black text-red-500 hover:bg-red-50 rounded-xl uppercase">–û—á–∏—Å—Ç–∏—Ç–∏</button>
        </div>

        <div class="flex-1 whiteboard-container bg-white rounded-[2.5rem] shadow-inner border border-slate-200 overflow-hidden relative" id="canvas-parent">
            <canvas id="whiteboard" class="cursor-crosshair"></canvas>
        </div>
        
        <div class="mt-4 flex justify-between items-center px-4 opacity-40">
            <span class="text-[10px] font-black uppercase tracking-widest">Interactive Sketchpad v4.0</span>
            <span class="text-[10px] font-black">MATH_STUDIO_READY</span>
        </div>
    </div>

    <div id="modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] hidden flex items-center justify-center p-6">
        <div class="bg-white rounded-[3rem] p-12 max-w-sm w-full text-center shadow-2xl">
            <div class="text-7xl mb-6">üèÜ</div>
            <h2 class="text-3xl font-black text-slate-800 mb-2">–£—Ä–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
            <p id="res-score" class="text-blue-600 font-black text-2xl mb-4"></p>
            <p id="res-msg" class="text-slate-500 mb-10 italic"></p>
            <button onclick="location.reload()" class="w-full bg-slate-900 text-white py-5 rounded-2xl font-bold hover:bg-blue-600 transition">–ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É</button>
        </div>
    </div>

<script>
    // --- –ë–ê–ó–ê –î–ê–ù–ò–• –ó–ê–í–î–ê–ù–¨ (30 –ü–£–ù–ö–¢–Ü–í) ---
    const tasksData = [
        // 14.9 –ü–æ–≤–Ω—ñ—Å—Ç—é
        { n: "14.9(1)", q: "\\( \\sqrt{25} \\)", a: "5", h: "–Ø–∫–µ —á–∏—Å–ª–æ –≤ –∫–≤–∞–¥—Ä–∞—Ç—ñ –¥–∞—î 25?", s: "5^2 = 25" },
        { n: "14.9(2)", q: "\\( \\sqrt{36} \\)", a: "6", h: "6 –ø–æ–º–Ω–æ–∂–∏—Ç–∏ –Ω–∞ 6 –±—É–¥–µ...", s: "6^2 = 36" },
        { n: "14.9(3)", q: "\\( \\sqrt{0,16} \\)", a: "0,4", h: "0,4 * 0,4 = 0,16", s: "0,4" },
        { n: "14.9(4)", q: "\\( \\sqrt{4900} \\)", a: "70", h: "sqrt(49) * sqrt(100)", s: "7 * 10 = 70" },
        { n: "14.9(5)", q: "\\( \\sqrt{0,04} \\)", a: "0,2", h: "0,2 * 0,2 = 0,04", s: "0,2" },
        { n: "14.9(6)", q: "\\( \\sqrt{\\frac{1}{64}} \\)", a: "1/8", h: "sqrt(1) / sqrt(64)", s: "1/8" },
        { n: "14.9(7)", q: "\\( \\sqrt{1 \\frac{11}{25}} \\)", a: "1,2", h: "–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –¥—Ä—ñ–±: 36/25", s: "sqrt(36/25) = 6/5 = 1,2" },
        { n: "14.9(8)", q: "\\( \\sqrt{3 \\frac{1}{16}} \\)", a: "1,75", h: "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –¥—Ä—ñ–±: 49/16", s: "sqrt(49/16) = 7/4 = 1,75" },
        
        // 14.10 –ü–æ–≤–Ω—ñ—Å—Ç—é
        { n: "14.10(1)", q: "–ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Ä—ñ–≤–Ω—ñ—Å—Ç—å: \\( \\sqrt{900} = 30 \\)? (—Ç–∞–∫/–Ω—ñ)", a: "—Ç–∞–∫", h: "30 * 30 = 900", s: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ." },
        { n: "14.10(2)", q: "–ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Ä—ñ–≤–Ω—ñ—Å—Ç—å: \\( \\sqrt{4} = -2 \\)? (—Ç–∞–∫/–Ω—ñ)", a: "–Ω—ñ", h: "–ö–æ—Ä—ñ–Ω—å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥'—î–º–Ω–∏–º –∑–∞ –æ–∑–Ω–∞—á–µ–Ω–Ω—è–º!", s: "–ù—ñ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∂–¥–∏ >= 0." },
        { n: "14.10(3)", q: "–ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Ä—ñ–≤–Ω—ñ—Å—Ç—å: \\( \\sqrt{0,9} = 0,3 \\)? (—Ç–∞–∫/–Ω—ñ)", a: "–Ω—ñ", h: "0,3 * 0,3 = 0,09, –∞ –Ω–µ 0,9", s: "–ù—ñ, sqrt(0,09)=0,3." },
        { n: "14.10(4)", q: "–ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Ä—ñ–≤–Ω—ñ—Å—Ç—å: \\( \\sqrt{0,64} = 0,8 \\)? (—Ç–∞–∫/–Ω—ñ)", a: "—Ç–∞–∫", h: "0,8^2 = 0,64", s: "–¢–∞–∫, –ø—Ä–∞–≤–∏–ª—å–Ω–æ." },

        // 14.11
        { n: "14.11(1)", q: "\\( \\sqrt{1296} \\) (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π —Ç–∞–±–ª–∏—Ü—é)", a: "36", h: "–ó–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 6, –æ—Ç–∂–µ —Ü–µ 34 –∞–±–æ 36.", s: "36" },
        { n: "14.11(2)", q: "\\( \\sqrt{9409} \\)", a: "97", h: "–ë–ª–∏–∑—å–∫–æ –¥–æ 100^2=10000", s: "97" },
        { n: "14.11(4)", q: "\\( \\sqrt{30,25} \\)", a: "5,5", h: "55^2 = 3025", s: "5,5" },

        // 14.12
        { n: "14.12(1)", q: "–ó–Ω–∞—á–µ–Ω–Ω—è –≤–∏—Ä–∞–∑—É: \\( \\sqrt{64} + \\sqrt{25} \\)", a: "13", h: "8 + 5", s: "8 + 5 = 13" },
        { n: "14.12(3)", q: "–ó–Ω–∞—á–µ–Ω–Ω—è: \\( 2\\sqrt{100} - \\sqrt{144} \\)", a: "8", h: "2 * 10 - 12", s: "20 - 12 = 8" },
        { n: "14.12(6)", q: "–ó–Ω–∞—á–µ–Ω–Ω—è: \\( \\sqrt{5^2 - 25} \\)", a: "0", h: "25 - 25", s: "sqrt(0) = 0" },

        // 14.16
        { n: "14.16(1)", q: "–†–æ–∑–≤'—è–∂—ñ—Ç—å: \\( \\sqrt{x} = 2 \\)", a: "4", h: "x = 2^2", s: "x = 4" },
        { n: "14.16(3)", q: "–†–æ–∑–≤'—è–∂—ñ—Ç—å: \\( \\sqrt{x} = -2 \\) (—è–∫—â–æ –Ω–µ–º–∞—î, –ø–∏—à–∏ '–Ω–µ–º–∞—î')", a: "–Ω–µ–º–∞—î", h: "–ö–æ—Ä—ñ–Ω—å –Ω–µ –±—É–≤–∞—î –≤—ñ–¥'—î–º–Ω–∏–º.", s: "–†—ñ—à–µ–Ω—å –Ω–µ–º–∞—î." },
        { n: "14.16(5)", q: "–†–æ–∑–≤'—è–∂—ñ—Ç—å: \\( 2\\sqrt{x} = 8 \\)", a: "16", h: "–°–ø–æ—á–∞—Ç–∫—É –ø–æ–¥—ñ–ª–∏ –Ω–∞ 2.", s: "sqrt(x)=4 => x=16" },

        // 14.18
        { n: "14.18(1)", q: "–ß–∏ –º–∞—î –∑–º—ñ—Å—Ç –≤–∏—Ä–∞–∑: \\( \\sqrt{12 \\cdot 14 - 13^2} \\)? (—Ç–∞–∫/–Ω—ñ)", a: "–Ω—ñ", h: "168 - 169 = -1", s: "–ü—ñ–¥ –∫–æ—Ä–µ–Ω–µ–º -1. –ù—ñ." },
        
        // 15.10 (–ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è)
        { n: "15.10(1)", q: "–ß–∏ –ø—Ä–∞–≤–¥–∞: \( 7 \notin \mathbb{N} \)? (—Ç–∞–∫/–Ω—ñ)", a: "–Ω—ñ", h: "7 - –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–µ —á–∏—Å–ª–æ.", s: "–ù—ñ, –±–æ 7 —î –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–º." },
        { n: "15.10(6)", q: "–ß–∏ –ø—Ä–∞–≤–¥–∞: \( -9,2 \in \mathbb{Q} \)? (—Ç–∞–∫/–Ω—ñ)", a: "—Ç–∞–∫", h: "–†–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ - —Ü–µ —ñ –¥—Ä–æ–±–∏.", s: "–¢–∞–∫." },
        { n: "15.10(8)", q: "–ß–∏ –ø—Ä–∞–≤–¥–∞: \( \\sqrt{3} \in \mathbb{Q} \)? (—Ç–∞–∫/–Ω—ñ)", a: "–Ω—ñ", h: "–¶–µ —ñ—Ä—Ä–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ —á–∏—Å–ª–æ.", s: "–ù—ñ." },
        { n: "15.10(11)", q: "–ß–∏ –ø—Ä–∞–≤–¥–∞: \( \\sqrt{\\frac{4}{9}} \notin \mathbb{Z} \)? (—Ç–∞–∫/–Ω—ñ)", a: "—Ç–∞–∫", h: "–¶–µ 2/3. –ê 2/3 - —Ü–µ —Ü—ñ–ª–µ?", s: "–¢–∞–∫, —Ü–µ –Ω–µ —Ü—ñ–ª–µ —á–∏—Å–ª–æ." },

        // 15.11 (–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è)
        { n: "15.11(3)", q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ \( -\\frac{1}{17} \) —Ç–∞ 0. –©–æ –±—ñ–ª—å—à–µ? (–ø–∏—à–∏ —á–∏—Å–ª–æ)", a: "0", h: "–ù—É–ª—å –±—ñ–ª—å—à–µ –∑–∞ –±—É–¥—å-—è–∫–µ –≤—ñ–¥'—î–º–Ω–µ.", s: "0" },
        { n: "15.11(4)", q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ \( \pi \) —Ç–∞ 3,2. –©–æ –º–µ–Ω—à–µ?", a: "pi", h: "–ü—ñ –ø—Ä–∏–±–ª–∏–∑–Ω–æ 3,14", s: "pi < 3,2" },
        { n: "15.11(5)", q: "–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ \( -\pi \) —Ç–∞ -3,1. –©–æ –±—ñ–ª—å—à–µ?", a: "-3,1", h: "-3,14... –º–µ–Ω—à–µ –Ω—ñ–∂ -3,1", s: "-3,1" },
        { n: "15.11(8)", q: "–©–æ –º–µ–Ω—à–µ: \( \\sqrt{3} \) —á–∏ 1,8?", a: "sqrt(3)", h: "sqrt(3) ‚âà 1,73", s: "sqrt(3) < 1,8" }
    ];

    let solved = 0;

    // –ì–ï–ù–ï–†–ê–¶–Ü–Ø –Ü–ù–¢–ï–†–§–ï–ô–°–£ –ó–ê–í–î–ê–ù–¨
    function initTasks() {
        const container = document.getElementById('tasks-list');
        let currentBlock = "";

        tasksData.forEach((task, index) => {
            const blockNum = task.n.split('(')[0];
            
            if (blockNum !== currentBlock) {
                currentBlock = blockNum;
                const h = document.createElement('h2');
                h.className = "text-xl font-black text-slate-800 flex items-center gap-3 border-l-4 border-blue-600 pl-4 my-8";
                h.innerHTML = `–ë–ª–æ–∫ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Ññ${currentBlock}`;
                container.appendChild(h);
            }

            const div = document.createElement('div');
            div.id = `task-container-${index}`;
            div.className = "task-card bg-white p-6 rounded-3xl";
            div.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">${task.n}</span>
                    <div id="status-${index}" class="hidden text-green-500 font-bold text-xs flex items-center gap-1">
                        –í–∏–∫–æ–Ω–∞–Ω–æ <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"></path></svg>
                    </div>
                </div>
                <div class="text-lg font-semibold text-slate-700 mb-6">${task.q}</div>
                <div class="flex gap-2">
                    <input type="text" id="ans-${index}" onkeypress="if(event.key==='Enter') checkAnswer(${index})" 
                        class="flex-1 bg-slate-50 border-2 border-slate-50 rounded-2xl px-5 py-3 focus:outline-none focus:border-blue-500 transition-all" 
                        placeholder="–¢–≤–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å...">
                    <button onclick="checkAnswer(${index})" class="bg-slate-900 text-white px-6 py-3 rounded-2xl font-bold hover:bg-blue-700 transition active:scale-95">–î–æ–±—Ä–µ</button>
                </div>
                <div class="flex gap-4 mt-4">
                    <button onclick="toggleHelp(${index}, 'h')" class="text-[10px] font-bold text-blue-500 uppercase">–ü—ñ–¥–∫–∞–∑–∫–∞</button>
                    <button onclick="toggleHelp(${index}, 's')" class="text-[10px] font-bold text-slate-300 uppercase ml-auto">–ü–æ–≤–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫</button>
                </div>
                <div id="hint-${index}" class="hidden mt-3 p-4 bg-blue-50 text-blue-700 rounded-2xl text-xs border border-blue-100 italic">üí° ${task.h}</div>
                <div id="sol-${index}" class="hidden mt-3 p-4 bg-slate-100 text-slate-600 rounded-2xl text-xs border border-slate-200 font-mono">${task.s}</div>
            `;
            container.appendChild(div);
        });
        MathJax.typeset();
    }

    function checkAnswer(idx) {
        const input = document.getElementById(`ans-${idx}`);
        const user = input.value.trim().toLowerCase().replace(',', '.');
        const correct = tasksData[idx].a.toLowerCase().replace(',', '.');

        if (user === correct || (user === "pi" && correct === "pi")) {
            if (!document.getElementById(`task-container-${idx}`).classList.contains('solved-card')) {
                solved++;
                updateProg();
            }
            document.getElementById(`task-container-${idx}`).classList.add('solved-card');
            document.getElementById(`status-${idx}`).classList.remove('hidden');
            input.classList.remove('border-red-500');
        } else {
            input.classList.add('border-red-500');
            setTimeout(() => input.classList.remove('border-red-500'), 500);
        }
    }

    function updateProg() {
        const p = Math.round((solved / tasksData.length) * 100);
        document.getElementById('prog-bar').style.width = p + '%';
        document.getElementById('prog-label').innerText = `–ü—Ä–æ–≥—Ä–µ—Å: ${solved}/${tasksData.length}`;
    }

    function toggleHelp(idx, type) {
        const el = document.getElementById(type === 'h' ? `hint-${idx}` : `sol-${idx}`);
        el.classList.toggle('hidden');
    }

    // --- –õ–û–ì–Ü–ö–ê –î–û–®–ö–ò (CANVAS) ---
    const canvas = document.getElementById('whiteboard');
    const ctx = canvas.getContext('2d');
    let drawing = false;
    let tool = 'pen';

    function initCanvas() {
        const parent = document.getElementById('canvas-parent');
        canvas.width = parent.clientWidth;
        canvas.height = parent.clientHeight;
        ctx.lineCap = 'round';
        ctx.lineWidth = 3;
    }

    function setTool(t) {
        tool = t;
        document.getElementById('btn-pen').className = t === 'pen' ? 'p-3 rounded-xl tool-active' : 'p-3 rounded-xl hover:bg-slate-100';
        document.getElementById('btn-eraser').className = t === 'eraser' ? 'p-3 rounded-xl tool-active' : 'p-3 rounded-xl hover:bg-slate-100';
    }

    function startDraw(e) {
        drawing = true;
        ctx.beginPath();
        const pos = getPos(e);
        ctx.moveTo(pos.x, pos.y);
    }

    function draw(e) {
        if (!drawing) return;
        const pos = getPos(e);
        ctx.strokeStyle = tool === 'eraser' ? '#ffffff' : '#1e293b';
        ctx.lineWidth = tool === 'eraser' ? 30 : 3;
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
    }

    function getPos(e) {
        const r = canvas.getBoundingClientRect();
        const x = (e.clientX || (e.touches ? e.touches[0].clientX : 0)) - r.left;
        const y = (e.clientY || (e.touches ? e.touches[0].clientY : 0)) - r.top;
        return { x, y };
    }

    function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('mousemove', draw);
    window.addEventListener('mouseup', () => drawing = false);
    canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startDraw(e); });
    canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });

    // --- –§–Ü–ù–ê–õ ---
    function finishLesson() {
        const score = Math.round((solved / tasksData.length) * 100);
        document.getElementById('res-score').innerText = `${score}% (${solved}/${tasksData.length})`;
        const msg = document.getElementById('res-msg');
        
        if (score > 90) msg.innerText = "–¢–∏ ‚Äî –º–∞–π—Å—Ç–µ—Ä —Ä–∞–¥–∏–∫–∞–ª—ñ–≤! –Ü–¥–µ–∞–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞.";
        else if (score > 60) msg.innerText = "–î—É–∂–µ –¥–æ–±—Ä–µ! –¢–∏ –≤–ø–µ–≤–Ω–µ–Ω–æ –≤–æ–ª–æ–¥—ñ—î—à —Ç–µ–º–æ—é.";
        else msg.innerText = "–ù–µ–ø–æ–≥–∞–Ω–æ, –∞–ª–µ –≤–∞—Ä—Ç–æ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫—É–≤–∞—Ç–∏—Å—å —â–µ. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ª—é–±–∏—Ç—å —Ç–µ—Ä–ø—ñ–Ω–Ω—è!";
        
        document.getElementById('modal').classList.remove('hidden');
    }

    window.onload = () => { initTasks(); initCanvas(); };
    window.onresize = initCanvas;

</script>
</body>
</html>