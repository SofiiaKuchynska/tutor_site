<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sofiia | Smart Tutor Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .grid-5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; }
        @media (max-width: 1024px) { .grid-5 { grid-template-columns: 1fr; } }
        .slot-free { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; }
        .slot-busy { background: #f8fafc; border: 1px solid #e2e8f0; color: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 pb-10">

    <div class="max-w-[1400px] mx-auto px-4 py-6">
        <nav class="flex bg-white/80 backdrop-blur-md sticky top-4 z-50 p-1.5 rounded-2xl shadow-xl border border-slate-200 mb-10">
            <button onclick="showTab('public', this)" class="tab-btn flex-1 bg-indigo-600 text-white py-3 rounded-xl font-bold text-sm transition-all">–í—ñ–∫–æ–Ω—Ü—è</button>
            <button onclick="showTab('private', this)" class="tab-btn flex-1 text-slate-500 py-3 rounded-xl font-bold text-sm transition-all">–ú—ñ–π —Ä–æ–∑–∫–ª–∞–¥</button>
            <button onclick="showTab('log', this)" class="tab-btn flex-1 text-slate-500 py-3 rounded-xl font-bold text-sm transition-all">–ñ—É—Ä–Ω–∞–ª</button>
        </nav>

        <div id="public" class="tab-content block">
            <div class="bg-white p-6 rounded-[2.5rem] shadow-2xl border border-indigo-50">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-black text-slate-800">–í—ñ–ª—å–Ω—ñ –≤—ñ–∫–æ–Ω—Ü—è ‚ú®</h2>
                    <button onclick="copyFreeHours()" class="bg-indigo-600 text-white px-6 py-2 rounded-xl text-xs font-bold transition">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                </div>
                <div id="public-week" class="grid-5"></div>
            </div>
        </div>

        <div id="private" class="tab-content hidden">
            <div class="bg-white p-6 rounded-[2.5rem] shadow-2xl border border-slate-100">
                <h2 class="text-3xl font-black text-slate-800 mb-8">–ú—ñ–π —Ä–æ–∑–∫–ª–∞–¥</h2>
                <div id="private-week" class="grid-5"></div>
            </div>
        </div>

        <div id="log" class="tab-content hidden">
            <div class="bg-white rounded-[2.5rem] shadow-2xl border border-slate-100 overflow-hidden">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-slate-50 text-slate-400 text-[10px] uppercase tracking-widest">
                        <tr><th class="p-6">–î–∞—Ç–∞ / –£—á–µ–Ω—å</th><th class="p-6">–ü—Ä–æ–π–¥–µ–Ω–∞ —Ç–µ–º–∞</th><th class="p-6 text-center">–û—Ü—ñ–Ω–∫–∞</th></tr>
                    </thead>
                    <tbody id="log-body" class="divide-y divide-slate-50"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQgrwL7j8Mlat4GqhSWe9xAivXD_PzWZ0TRedmHRgVuv_x6Hv7J_Kf4B8duzcN6asmBwCureC2q8toG/pub?output=csv";
        
        // !!! –û–°–¨ –¶–ï–ô –†–Ø–î–û–ö, –Ø–ö–ò–ô –¢–ò –®–£–ö–ê–õ–ê !!!
        // –í—Å—Ç–∞–≤ —Å–≤–æ—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å –¢–ï–ö–°–¢–£ –í –õ–ê–ü–ö–ê–• –Ω–∏–∂—á–µ:
        const API_URL = "–í–°–¢–ê–í_–°–Æ–î–ò_–ü–û–°–ò–õ–ê–ù–ù–Ø_–Ø–ö–ï_–ó–ê–ö–Ü–ù–ß–£–Ñ–¢–¨–°–Ø_–ù–ê_EXEC";

        const DAYS = ["–ü–æ–Ω–µ–¥—ñ–ª–æ–∫", "–í—ñ–≤—Ç–æ—Ä–æ–∫", "–°–µ—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä", "–ü'—è—Ç–Ω–∏—Ü—è"];
        let freeSlotsText = "";

        function showTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('bg-indigo-600', 'text-white');
                b.classList.add('text-slate-500');
            });
            btn.classList.add('bg-indigo-600', 'text-white');
            btn.classList.remove('text-slate-500');
        }

        async function loadData() {
            try {
                const res = await fetch(SHEET_URL);
                const text = await res.text();
                const sep = text.split('\n')[0].includes(';') ? ';' : ',';
                const rows = text.split('\n').slice(1).filter(r => r.trim());
                const dayData = { "–ü–æ–Ω–µ–¥—ñ–ª–æ–∫": [], "–í—ñ–≤—Ç–æ—Ä–æ–∫": [], "–°–µ—Ä–µ–¥–∞": [], "–ß–µ—Ç–≤–µ—Ä": [], "–ü'—è—Ç–Ω–∏—Ü—è": [] };

                rows.forEach(line => {
                    const col = line.split(sep).map(c => c.replace(/^"|"$/g, '').trim());
                    const dayName = col[0].split(' ')[0];
                    if (dayData[dayName]) dayData[dayName].push({ 
                        date: col[0], time: col[1], student: col[2], subject: col[3],
                        link: col[4], status: col[5], topic: col[6], grade: col[8] 
                    });
                });
                renderPublic(dayData);
                renderPrivate(dayData);
                renderLog(rows, sep);
            } catch (err) { console.error(err); }
        }

        function renderPublic(data) {
            const grid = document.getElementById('public-week');
            grid.innerHTML = '';
            let copyText = "–í—ñ–ª—å–Ω—ñ –≤—ñ–∫–æ–Ω—Ü—è:\n";
            DAYS.forEach(day => {
                let html = `<div class="space-y-3"><h3 class="font-black text-xs text-slate-300 uppercase text-center mb-4">${day}</h3>`;
                data[day].forEach(s => {
                    const isFree = s.status.toLowerCase().includes('–≤—ñ–ª—å–Ω–æ');
                    const hour = parseInt(s.time);
                    if (hour < 16 && !s.student.includes("–í—Å–µ–≤–æ–ª–æ–¥")) return;
                    html += `<div class="p-4 rounded-2xl text-center text-sm font-bold shadow-sm ${isFree ? 'slot-free' : 'slot-busy'}">${s.time} ${isFree ? '‚ú®' : ''}</div>`;
                    if (isFree) copyText += `‚Ä¢ ${day}: ${s.time}\n`;
                });
                grid.innerHTML += html + `</div>`;
            });
            freeSlotsText = copyText;
        }

        function renderPrivate(data) {
            const grid = document.getElementById('private-week');
            grid.innerHTML = '';
            DAYS.forEach(day => {
                let html = `<div class="space-y-4"><h3 class="font-black text-xs text-indigo-400 uppercase text-center bg-indigo-50/50 py-2 rounded-xl mb-4">${day}</h3>`;
                data[day].forEach((s, idx) => {
                    if (s.status.toLowerCase().includes('–≤—ñ–ª—å–Ω–æ')) return;
                    const url = s.link.includes('http') ? s.link : 'https://meet.google.com';
                    const safeID = `${day}-${idx}`;
                    html += `<div class="bg-white p-5 rounded-[2rem] border border-slate-100 shadow-sm space-y-4">
                        <div><div class="text-[10px] font-black text-indigo-500 uppercase">${s.time}</div><div class="font-black text-slate-800 text-lg">${s.student}</div></div>
                        <div class="space-y-2">
                            <input type="text" id="t-${safeID}" placeholder="–¢–µ–º–∞" value="${s.topic || ''}" class="w-full text-[11px] p-3 bg-slate-50 rounded-xl outline-none focus:ring-1 focus:ring-indigo-400">
                            <div class="flex gap-2">
                                <input type="text" id="g-${safeID}" placeholder="–ë–∞–ª" value="${s.grade || ''}" class="w-14 text-[11px] p-3 bg-slate-50 rounded-xl text-center outline-none">
                                <button onclick="saveData('${s.date}', '${s.time}', '${s.student}', '${safeID}')" class="flex-1 bg-indigo-600 text-white text-[10px] font-black py-3 rounded-xl active:scale-95 transition">–ó–ë–ï–†–ï–ì–¢–ò</button>
                            </div>
                        </div>
                        <a href="${url}" target="_blank" class="block w-full text-center bg-slate-900 text-white py-3 rounded-2xl font-black text-[10px] tracking-widest">–£–†–û–ö ‚Æï</a>
                    </div>`;
                });
                grid.innerHTML += html + `</div>`;
            });
        }

        async function saveData(day, time, student, id) {
            const topic = document.getElementById(`t-${id}`).value;
            const grade = document.getElementById(`g-${id}`).value;
            const btn = event.target;
            btn.innerText = "‚è≥";
            btn.disabled = true;
            try {
                await fetch(API_URL, {
                    method: "POST",
                    mode: "no-cors",
                    body: JSON.stringify({ day, time, student, topic, grade, hw: "" })
                });
                btn.innerText = "OK! ‚úì";
                btn.classList.replace('bg-indigo-600', 'bg-green-500');
                setTimeout(() => { btn.innerText = "–ó–ë–ï–†–ï–ì–¢–ò"; btn.classList.replace('bg-green-500', 'bg-indigo-600'); btn.disabled = false; }, 2000);
            } catch (e) { alert("–ü–æ–º–∏–ª–∫–∞!"); btn.disabled = false; }
        }

        function renderLog(rows, sep) {
            const body = document.getElementById('log-body');
            body.innerHTML = '';
            rows.forEach(r => {
                const c = r.split(sep).map(col => col.replace(/^"|"$/g, '').trim());
                if (!c[6] || c[6] === '-') return;
                body.innerHTML += `<tr class="bg-white"><td class="p-6"><div class="text-[10px] text-slate-300 font-bold">${c[0]}</div><div class="font-bold text-slate-800">${c[2]}</div></td><td class="p-6 text-xs text-slate-500 italic leading-relaxed">${c[6]}</td><td class="p-6 text-center font-black text-indigo-600">${c[8] || ''}</td></tr>`;
            });
        }

        function copyFreeHours() { navigator.clipboard.writeText(freeSlotsText).then(() => alert("–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! ‚ú®")); }
        loadData();
    </script>
</body>
</html><!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sofiia | Smart Tutor Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .grid-5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; }
        @media (max-width: 1024px) { .grid-5 { grid-template-columns: 1fr; } }
        .slot-free { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; }
        .slot-busy { background: #f8fafc; border: 1px solid #e2e8f0; color: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 pb-10">

    <div class="max-w-[1400px] mx-auto px-4 py-6">
        <nav class="flex bg-white/80 backdrop-blur-md sticky top-4 z-50 p-1.5 rounded-2xl shadow-xl border border-slate-200 mb-10">
            <button onclick="showTab('public', this)" class="tab-btn flex-1 bg-indigo-600 text-white py-3 rounded-xl font-bold text-sm transition-all">–í—ñ–∫–æ–Ω—Ü—è</button>
            <button onclick="showTab('private', this)" class="tab-btn flex-1 text-slate-500 py-3 rounded-xl font-bold text-sm transition-all">–ú—ñ–π —Ä–æ–∑–∫–ª–∞–¥</button>
            <button onclick="showTab('log', this)" class="tab-btn flex-1 text-slate-500 py-3 rounded-xl font-bold text-sm transition-all">–ñ—É—Ä–Ω–∞–ª</button>
        </nav>

        <div id="public" class="tab-content block">
            <div class="bg-white p-6 rounded-[2.5rem] shadow-2xl border border-indigo-50">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-black text-slate-800">–í—ñ–ª—å–Ω—ñ –≤—ñ–∫–æ–Ω—Ü—è ‚ú®</h2>
                    <button onclick="copyFreeHours()" class="bg-indigo-600 text-white px-6 py-2 rounded-xl text-xs font-bold transition">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                </div>
                <div id="public-week" class="grid-5"></div>
            </div>
        </div>

        <div id="private" class="tab-content hidden">
            <div class="bg-white p-6 rounded-[2.5rem] shadow-2xl border border-slate-100">
                <h2 class="text-3xl font-black text-slate-800 mb-8">–ú—ñ–π —Ä–æ–∑–∫–ª–∞–¥</h2>
                <div id="private-week" class="grid-5"></div>
            </div>
        </div>

        <div id="log" class="tab-content hidden">
            <div class="bg-white rounded-[2.5rem] shadow-2xl border border-slate-100 overflow-hidden">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-slate-50 text-slate-400 text-[10px] uppercase tracking-widest">
                        <tr><th class="p-6">–î–∞—Ç–∞ / –£—á–µ–Ω—å</th><th class="p-6">–ü—Ä–æ–π–¥–µ–Ω–∞ —Ç–µ–º–∞</th><th class="p-6 text-center">–û—Ü—ñ–Ω–∫–∞</th></tr>
                    </thead>
                    <tbody id="log-body" class="divide-y divide-slate-50"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQgrwL7j8Mlat4GqhSWe9xAivXD_PzWZ0TRedmHRgVuv_x6Hv7J_Kf4B8duzcN6asmBwCureC2q8toG/pub?output=csv";
        
        // !!! –û–°–¨ –¶–ï–ô –†–Ø–î–û–ö, –Ø–ö–ò–ô –¢–ò –®–£–ö–ê–õ–ê !!!
        // –í—Å—Ç–∞–≤ —Å–≤–æ—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å –¢–ï–ö–°–¢–£ –í –õ–ê–ü–ö–ê–• –Ω–∏–∂—á–µ:
        const API_URL = "https://script.google.com/macros/s/AKfycbx8spV7-VAOd2M6bmXUT1pg3nSMtHQ6NenIBQQAcBEIeQRlYEadieVUAzCQsNkLFWcV/exec";

        const DAYS = ["–ü–æ–Ω–µ–¥—ñ–ª–æ–∫", "–í—ñ–≤—Ç–æ—Ä–æ–∫", "–°–µ—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä", "–ü'—è—Ç–Ω–∏—Ü—è"];
        let freeSlotsText = "";

        function showTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('bg-indigo-600', 'text-white');
                b.classList.add('text-slate-500');
            });
            btn.classList.add('bg-indigo-600', 'text-white');
            btn.classList.remove('text-slate-500');
        }

        async function loadData() {
            try {
                const res = await fetch(SHEET_URL);
                const text = await res.text();
                const sep = text.split('\n')[0].includes(';') ? ';' : ',';
                const rows = text.split('\n').slice(1).filter(r => r.trim());
                const dayData = { "–ü–æ–Ω–µ–¥—ñ–ª–æ–∫": [], "–í—ñ–≤—Ç–æ—Ä–æ–∫": [], "–°–µ—Ä–µ–¥–∞": [], "–ß–µ—Ç–≤–µ—Ä": [], "–ü'—è—Ç–Ω–∏—Ü—è": [] };

                rows.forEach(line => {
                    const col = line.split(sep).map(c => c.replace(/^"|"$/g, '').trim());
                    const dayName = col[0].split(' ')[0];
                    if (dayData[dayName]) dayData[dayName].push({ 
                        date: col[0], time: col[1], student: col[2], subject: col[3],
                        link: col[4], status: col[5], topic: col[6], grade: col[8] 
                    });
                });
                renderPublic(dayData);
                renderPrivate(dayData);
                renderLog(rows, sep);
            } catch (err) { console.error(err); }
        }

        function renderPublic(data) {
            const grid = document.getElementById('public-week');
            grid.innerHTML = '';
            let copyText = "–í—ñ–ª—å–Ω—ñ –≤—ñ–∫–æ–Ω—Ü—è:\n";
            DAYS.forEach(day => {
                let html = `<div class="space-y-3"><h3 class="font-black text-xs text-slate-300 uppercase text-center mb-4">${day}</h3>`;
                data[day].forEach(s => {
                    const isFree = s.status.toLowerCase().includes('–≤—ñ–ª—å–Ω–æ');
                    const hour = parseInt(s.time);
                    if (hour < 16 && !s.student.includes("–í—Å–µ–≤–æ–ª–æ–¥")) return;
                    html += `<div class="p-4 rounded-2xl text-center text-sm font-bold shadow-sm ${isFree ? 'slot-free' : 'slot-busy'}">${s.time} ${isFree ? '‚ú®' : ''}</div>`;
                    if (isFree) copyText += `‚Ä¢ ${day}: ${s.time}\n`;
                });
                grid.innerHTML += html + `</div>`;
            });
            freeSlotsText = copyText;
        }

        function renderPrivate(data) {
            const grid = document.getElementById('private-week');
            grid.innerHTML = '';
            DAYS.forEach(day => {
                let html = `<div class="space-y-4"><h3 class="font-black text-xs text-indigo-400 uppercase text-center bg-indigo-50/50 py-2 rounded-xl mb-4">${day}</h3>`;
                data[day].forEach((s, idx) => {
                    if (s.status.toLowerCase().includes('–≤—ñ–ª—å–Ω–æ')) return;
                    const url = s.link.includes('http') ? s.link : 'https://meet.google.com';
                    const safeID = `${day}-${idx}`;
                    html += `<div class="bg-white p-5 rounded-[2rem] border border-slate-100 shadow-sm space-y-4">
                        <div><div class="text-[10px] font-black text-indigo-500 uppercase">${s.time}</div><div class="font-black text-slate-800 text-lg">${s.student}</div></div>
                        <div class="space-y-2">
                            <input type="text" id="t-${safeID}" placeholder="–¢–µ–º–∞" value="${s.topic || ''}" class="w-full text-[11px] p-3 bg-slate-50 rounded-xl outline-none focus:ring-1 focus:ring-indigo-400">
                            <div class="flex gap-2">
                                <input type="text" id="g-${safeID}" placeholder="–ë–∞–ª" value="${s.grade || ''}" class="w-14 text-[11px] p-3 bg-slate-50 rounded-xl text-center outline-none">
                                <button onclick="saveData('${s.date}', '${s.time}', '${s.student}', '${safeID}')" class="flex-1 bg-indigo-600 text-white text-[10px] font-black py-3 rounded-xl active:scale-95 transition">–ó–ë–ï–†–ï–ì–¢–ò</button>
                            </div>
                        </div>
                        <a href="${url}" target="_blank" class="block w-full text-center bg-slate-900 text-white py-3 rounded-2xl font-black text-[10px] tracking-widest">–£–†–û–ö ‚Æï</a>
                    </div>`;
                });
                grid.innerHTML += html + `</div>`;
            });
        }

        async function saveData(day, time, student, id) {
            const topic = document.getElementById(`t-${id}`).value;
            const grade = document.getElementById(`g-${id}`).value;
            const btn = event.target;
            btn.innerText = "‚è≥";
            btn.disabled = true;
            try {
                await fetch(API_URL, {
                    method: "POST",
                    mode: "no-cors",
                    body: JSON.stringify({ day, time, student, topic, grade, hw: "" })
                });
                btn.innerText = "OK! ‚úì";
                btn.classList.replace('bg-indigo-600', 'bg-green-500');
                setTimeout(() => { btn.innerText = "–ó–ë–ï–†–ï–ì–¢–ò"; btn.classList.replace('bg-green-500', 'bg-indigo-600'); btn.disabled = false; }, 2000);
            } catch (e) { alert("–ü–æ–º–∏–ª–∫–∞!"); btn.disabled = false; }
        }

        function renderLog(rows, sep) {
            const body = document.getElementById('log-body');
            body.innerHTML = '';
            rows.forEach(r => {
                const c = r.split(sep).map(col => col.replace(/^"|"$/g, '').trim());
                if (!c[6] || c[6] === '-') return;
                body.innerHTML += `<tr class="bg-white"><td class="p-6"><div class="text-[10px] text-slate-300 font-bold">${c[0]}</div><div class="font-bold text-slate-800">${c[2]}</div></td><td class="p-6 text-xs text-slate-500 italic leading-relaxed">${c[6]}</td><td class="p-6 text-center font-black text-indigo-600">${c[8] || ''}</td></tr>`;
            });
        }

        function copyFreeHours() { navigator.clipboard.writeText(freeSlotsText).then(() => alert("–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! ‚ú®")); }
        loadData();
    </script>
</body>
</html>
